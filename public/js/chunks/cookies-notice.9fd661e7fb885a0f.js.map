{"version":3,"file":"js/chunks/cookies-notice.9fd661e7fb885a0f.js","mappings":"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","sources":["webpack://multi-kelnik-2.0/./node_modules/js-cookie/dist/js.cookie.mjs","webpack://multi-kelnik-2.0/./frontend/src/components/cookies-notice/types.ts","webpack://multi-kelnik-2.0/./frontend/src/components/cookies-notice/index.ts"],"sourcesContent":["/*! js-cookie v3.0.5 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (name, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    name = encodeURIComponent(name)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      name + '=' + converter.write(value, name) + stringifiedAttributes)\n  }\n\n  function get (name) {\n    if (typeof document === 'undefined' || (arguments.length && !name)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var found = decodeURIComponent(parts[0]);\n        jar[found] = converter.read(value, found);\n\n        if (name === found) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return name ? jar[name] : jar\n  }\n\n  return Object.create(\n    {\n      set,\n      get,\n      remove: function (name, attributes) {\n        set(\n          name,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport { api as default };\n","export enum ECookiesNoticeState {\r\n    SHOW = 'is-show',\r\n    OPEN = 'is-open'\r\n}\r\n\r\nexport interface ICookiesNotice {\r\n    init(wrapper: HTMLElement): void;\r\n}\r\n","import Cookies from 'js-cookie';\r\nimport {ECookiesNoticeState} from './types';\r\nimport type {ICookiesNotice} from './types';\r\n\r\nconst DAY_MILLISECONDS = 24 * 60 * 60 * 1000;\r\nconst SHOW_DELAY = 1500;\r\nconst COOKIE_NAME = 'alert-cookie-accepted';\r\n\r\nclass CookiesNotice implements ICookiesNotice {\r\n    private wrapper: HTMLElement;\r\n    private timer: string | boolean;\r\n    private date: number = new Date().getTime();\r\n    private button: Element | null;\r\n\r\n    /**\r\n     * Метод инициализирует модуль.\r\n     * @param {HTMLElement} wrapper - элемент куки плашки\r\n     */\r\n    public init(wrapper: HTMLElement): void {\r\n        this.wrapper = wrapper;\r\n        this.timer = this.wrapper.dataset['timer'] || false;\r\n        this.button = this.wrapper.querySelector('.j-cookies-notice__button');\r\n\r\n        this._bindEvents();\r\n        this._check();\r\n    }\r\n\r\n    /**\r\n     * Метод навешивает обработчики на элементы.\r\n     * @private\r\n     */\r\n    private _bindEvents(): void {\r\n        if (this.button) {\r\n            this.button.addEventListener('click', this._close.bind(this));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Метод проверяет наличие куки.\r\n     * @private\r\n     */\r\n    private _check(): void {\r\n        // Дата, когда была записана кука\r\n        const cookiesTime = Number(Cookies.get(COOKIE_NAME));\r\n        // Сколько прошло времени\r\n        const spentTime = this.date - cookiesTime;\r\n        // Если стоит таймер\r\n        const timerData = this.timer ? DAY_MILLISECONDS * Number(this.timer) : 0;\r\n        // Когда истекает запись\r\n        const dateOver = cookiesTime + timerData;\r\n\r\n        if (!cookiesTime) {\r\n            this._show();\r\n        } else if ((spentTime > dateOver) && this.timer) {\r\n            Cookies.remove(COOKIE_NAME);\r\n            this._show();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Метод показывает уведомление.\r\n     * @private\r\n     */\r\n    private _show(): void {\r\n        // Добавляем доп класс, что-бы уведомление не прыгало при загрузке страницы\r\n        this.wrapper.classList.add(ECookiesNoticeState.SHOW);\r\n\r\n        setTimeout(() => {\r\n            this.wrapper.classList.add(ECookiesNoticeState.OPEN);\r\n        }, SHOW_DELAY);\r\n    }\r\n\r\n    /**\r\n     * Метод закрывает уведомление и устанавливает куку.\r\n     * @private\r\n     */\r\n    private _close(): void {\r\n        Cookies.set(COOKIE_NAME, `${this.date}`);\r\n\r\n        this.wrapper.classList.remove(ECookiesNoticeState.OPEN, ECookiesNoticeState.SHOW);\r\n    }\r\n}\r\n\r\nexport default CookiesNotice;\r\n"],"names":["target","i","arguments","length","source","key","ECookiesNoticeState","api","init","converter","defaultAttributes","set","name","value","attributes","document","expires","Date","now","toUTCString","encodeURIComponent","replace","decodeURIComponent","escape","stringifiedAttributes","attributeName","split","cookie","write","Object","create","get","cookies","jar","parts","slice","join","found","read","e","remove","withAttributes","this","withConverter","freeze","path","COOKIE_NAME","CookiesNotice","_classCallCheck","_defineProperty","getTime","wrapper","timer","dataset","button","querySelector","_bindEvents","_check","addEventListener","_close","bind","cookiesTime","Number","Cookies","spentTime","date","timerData","_show","_this","classList","add","SHOW","setTimeout","OPEN","concat"],"sourceRoot":""}